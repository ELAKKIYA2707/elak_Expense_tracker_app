<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Expense Tracker — Working App</title>
<style>
:root{
  --card-bg: rgba(255,255,255,0.95);
  --accent: #00695c;
  --muted: #6b7280;
  --income: #16a34a;
  --expense: #dc2626;
  --glass: rgba(255,255,255,0.85);
  --shadow: 0 6px 18px rgba(2,6,23,0.12);
  font-family: Inter, "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:linear-gradient(135deg,#e6fffa 0%, #f0f9ff 100%);color:#111}
.landing {min-height:100vh; display:flex; align-items:center; justify-content:center; padding:24px;
  background-image: url('https://images.unsplash.com/photo-1593934872490-b1ebd8f1a5a4?q=80&w=1600&auto=format&fit=crop&ixlib=rb-4.0.3&s=2e152b85c1fc0d8e8e68e71b5ebd9b99');
  background-size: cover; background-position:center; color: white; text-align:center;
}
.landing .card {background: linear-gradient(180deg, rgba(0,0,0,0.35), rgba(0,0,0,0.25)); padding:36px; border-radius:14px; max-width:720px; box-shadow: 0 10px 40px rgba(2,6,23,0.45);}
.landing h1 { font-size:2.2rem; margin:0 0 12px; letter-spacing: -0.5px; }
.landing p { margin:0 0 20px; opacity:0.95; }
.btn {display:inline-block; padding:12px 20px; border-radius:10px; border:none; cursor:pointer; background:var(--accent); color:white; font-weight:600; box-shadow: 0 6px 18px rgba(0,0,0,0.15);}

.app-wrap{display:none; min-height:100vh; padding:28px; display:flex; align-items:flex-start; justify-content:center;}
.container{width:100%; max-width:980px; background:var(--card-bg); border-radius:14px; padding:22px; box-shadow: var(--shadow); display:grid; grid-template-columns: 1fr 360px; gap:18px;}

.main{padding-right:6px;}
h2 { margin:0 0 12px; font-size:1.25rem; color:#0f172a; }
.summary { display:flex; gap:12px; margin-bottom:14px; }
.tile{ flex:1; background:linear-gradient(180deg, var(--glass), rgba(255,255,255,0.92)); padding:12px; border-radius:10px; text-align:center; box-shadow: 0 4px 12px rgba(2,6,23,0.06);}
.tile h3 { margin:0; font-size:0.9rem; color:var(--muted) }
.tile p { margin:6px 0 0; font-weight:700; font-size:1.05rem }

.form { display:flex; gap:10px; margin-bottom:12px; align-items:center; }
.form .col { flex:1; display:flex; gap:8px; align-items:center; }
input[type="text"], input[type="number"]{ width:100%; padding:10px 12px; border-radius:8px; border:1px solid #e6edf0; background:white; font-size:0.95rem; }
.actions{ display:flex; gap:10px; margin-bottom:12px; }
.actions button{ flex:1; padding:10px; border-radius:8px; border:none; cursor:pointer; font-weight:600; }
.actions .add-income { background:var(--income); color:white }
.actions .add-expense { background:var(--expense); color:white }
.actions .clear-all { background:#374151; color:white }

.transactions { margin-top:6px; border-radius:10px; overflow:hidden; background: #fff; border: 1px solid #eef2f7; }
.tx-head{ display:flex; padding:10px 12px; background:#fafafa; border-bottom:1px solid #f1f5f9; gap:8px; align-items:center; }
.tx-head div { font-weight:700; color:#475569; font-size:0.9rem; }
ul.tx-list { list-style:none; margin:0; padding:0; max-height:340px; overflow:auto; }
li.tx { display:flex; justify-content:space-between; gap:12px; padding:10px 12px; align-items:center; border-bottom:1px dashed #eef2f7; }
.tx .meta { display:flex;flex-direction:column; gap:3px; max-width:64%; }
.tx .meta .desc { font-weight:600; color:#0f172a; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.tx .meta .date { font-size:0.82rem; color:var(--muted) }
.amount { font-weight:700; min-width:110px; text-align:right }
.amount.income { color:var(--income) }
.amount.expense { color:var(--expense) }
.tx .actions { display:flex; gap:8px; align-items:center }
.icon-btn { border:none; background:#f1f5f9; padding:6px 9px; border-radius:8px; cursor:pointer }
.icon-btn:hover { filter:brightness(.96) }

.side { padding-left:8px; display:flex; flex-direction:column; gap:12px; }
.card { background:linear-gradient(180deg,#fff,#fbfdff); border-radius:10px; padding:12px; box-shadow: 0 6px 18px rgba(2,6,23,0.04); border:1px solid #eef2f7; }

.home-btn { margin-bottom:12px; background:#0f172a; color:white; font-weight:600; border-radius:10px; padding:10px; cursor:pointer; border:none; }

@media (max-width:900px){
  .container{ grid-template-columns: 1fr; padding:14px }
  .app-wrap{ padding:14px }
  .side { padding-left:0 }
}
</style>
</head>
<body>

<section class="landing" id="landing">
  <div class="card">
    <h1>Expense Tracker</h1>
    <p>Track income and expenses, see totals, and manage transactions.</p>
    <div style="margin-top:18px">
      <button class="btn" id="enter-app-btn">Open App</button>
    </div>
  </div>
</section>

<main class="app-wrap" id="app-wrap" aria-hidden="true">
  <div class="container">
    <!-- Left -->
    <section class="main">
      <button class="home-btn" id="go-home-btn">← Go to Home</button>
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
        <h2>Overview</h2>
        <div style="color:var(--muted);font-size:0.92rem">LocalStorage saved • Works offline</div>
      </div>
      <div class="summary">
        <div class="tile"><h3>Balance</h3><p id="balance">₹0.00</p></div>
        <div class="tile"><h3>Total Income</h3><p id="total-income">₹0.00</p></div>
        <div class="tile"><h3>Total Expense</h3><p id="total-expense">₹0.00</p></div>
      </div>
      <div class="card" style="margin-bottom:12px">
        <div style="margin-bottom:10px;font-weight:700;color:#111">Add transaction</div>
        <div class="form">
          <div class="col"><input id="desc" type="text" placeholder="Description (e.g., Salary, Groceries)" maxlength="80" /></div>
          <div style="width:160px"><input id="amount" type="number" placeholder="Amount" step="0.01" /></div>
        </div>
        <div class="actions">
          <button id="add-income" class="add-income">+ Add Income</button>
          <button id="add-expense" class="add-expense">− Add Expense</button>
          <button id="clear-all" class="clear-all" title="Clear all transactions">Clear All</button>
        </div>
      </div>
      <div class="transactions card">
        <div class="tx-head"><div style="flex:1">Transaction</div><div style="width:110px;text-align:right">Amount</div></div>
        <ul class="tx-list" id="tx-list"></ul>
      </div>
    </section>

    <!-- Right: Search / Filter -->
    <aside class="side">
      <div class="card">
        <div style="font-weight:700;margin-bottom:6px">Search / Filter</div>
        <input type="text" id="search-tx" placeholder="Search description..." style="width:100%;padding:8px;border-radius:6px;border:1px solid #e6edf0;margin-bottom:8px"/>
        <select id="filter-type" style="width:100%;padding:8px;border-radius:6px;border:1px solid #e6edf0">
          <option value="all">All Transactions</option>
          <option value="income">Income</option>
          <option value="expense">Expense</option>
        </select>
      </div>
      <div class="card" style="text-align:center;color:var(--muted);font-size:0.92rem">
        <div style="font-weight:700;margin-bottom:6px">Export / Import</div>
        <div style="display:flex;gap:8px;justify-content:center">
          <button id="export-json" class="icon-btn">Export JSON</button>
          <button id="import-json" class="icon-btn">Import JSON</button>
          <input id="import-file" type="file" accept="application/json" style="display:none" />
        </div>
      </div>
    </aside>
  </div>
</main>

<script>
const LS_KEY = 'expense_tracker_transactions_v3';
const q = sel => document.querySelector(sel);
const formatCurrency = n => new Intl.NumberFormat('en-IN', { style:'currency', currency:'INR' }).format(n);

const landing = q('#landing'), appWrap = q('#app-wrap'), enterBtn = q('#enter-app-btn');
const descInput = q('#desc'), amountInput = q('#amount');
const addIncomeBtn = q('#add-income'), addExpenseBtn = q('#add-expense'), clearAllBtn = q('#clear-all');
const txList = q('#tx-list'), balanceEl = q('#balance'), incomeEl = q('#total-income'), expenseEl = q('#total-expense');
const exportBtn = q('#export-json'), importBtn = q('#import-json'), importFile = q('#import-file');
const searchInput = q('#search-tx'), filterSelect = q('#filter-type');
const goHomeBtn = q('#go-home-btn');

let transactions = [];

enterBtn.onclick = () => { landing.style.display='none'; appWrap.style.display='flex'; appWrap.setAttribute('aria-hidden','false'); }
goHomeBtn.onclick = () => { appWrap.style.display='none'; landing.style.display='flex'; appWrap.setAttribute('aria-hidden','true'); }

addIncomeBtn.onclick = () => addTransaction('income');
addExpenseBtn.onclick = () => addTransaction('expense');
clearAllBtn.onclick = () => { if(confirm('Clear ALL transactions?')){ transactions=[]; saveRender(); } }
exportBtn.onclick = () => {
  const blob = new Blob([JSON.stringify(transactions,null,2)],{type:'application/json'});
  const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download='expense-data.json'; a.click();
}
importBtn.onclick = () => importFile.click();
importFile.onchange = (e) => {
  const file = e.target.files[0]; if(!file) return;
  const reader = new FileReader();
  reader.onload = evt => {
    try {
      const imported = JSON.parse(evt.target.result);
      const valid = imported.filter(it=>it && typeof it.desc==='string' && typeof it.amount==='number' && (it.type==='income'||it.type==='expense'));
      if(!valid.length){ alert('No valid transactions'); return; }
      if(confirm(`Import ${valid.length} transactions?`)){ valid.forEach(it=>{ if(!it.date) it.date=new Date().toISOString(); if(!it.id) it.id=Date.now()+Math.floor(Math.random()*999); }); transactions=transactions.concat(valid); saveRender(); alert('Imported successfully'); }
    } catch(err){ alert('Import failed: '+err.message);}
  };
  reader.readAsText(file);
}

function saveRender(){ localStorage.setItem(LS_KEY,JSON.stringify(transactions)); renderAll(); }
function load(){ transactions=JSON.parse(localStorage.getItem(LS_KEY)||'[]'); renderAll(); }
function addTransaction(type){
  const desc=descInput.value.trim(), amt=parseFloat(amountInput.value);
  if(!desc){ alert('Enter description'); return; }
  if(!amt || amt<=0){ alert('Enter valid amount'); return; }
  transactions.push({id:Date.now(),desc,amount:+amt.toFixed(2),type,date:new Date().toISOString()});
  descInput.value=''; amountInput.value=''; saveRender();
}
function deleteTransaction(id){ if(confirm('Delete this transaction?')){ transactions=transactions.filter(t=>t.id!==id); saveRender(); } }

function renderAll(){
  // Summary
  let totalIncome=0,totalExpense=0;
  transactions.forEach(t=> t.type==='income'?totalIncome+=t.amount:totalExpense+=t.amount);
  balanceEl.textContent=formatCurrency(totalIncome-totalExpense);
  incomeEl.textContent=formatCurrency(totalIncome);
  expenseEl.textContent=formatCurrency(totalExpense);

  // Transactions list with search/filter
  const filter = filterSelect.value, search = searchInput.value.toLowerCase();
  const filtered = transactions.filter(t => (filter==='all'||t.type===filter) && t.desc.toLowerCase().includes(search));
  txList.innerHTML='';
  if(!filtered.length){ txList.innerHTML='<li class="tx"><div class="meta" style="opacity:0.85">No transactions.</div></li>'; return; }

  filtered.sort((a,b)=>b.date.localeCompare(a.date)).forEach(t=>{
    const li=document.createElement('li'); li.className='tx';
    const d=new Date(t.date);
    li.innerHTML=`<div class="meta"><div class="desc">${t.desc}</div><div class="date">${d.toLocaleString('en-IN',{year:'numeric',month:'short',day:'numeric',hour:'2-digit',minute:'2-digit'})}</div></div>
    <div style="display:flex;align-items:center;gap:8px"><div class="amount ${t.type}">${t.type==='income'?'+':'−'} ${formatCurrency(t.amount)}</div>
    <div class="actions"><button class="icon-btn">Delete</button></div></div>`;
    li.querySelector('.icon-btn').onclick=()=>deleteTransaction(t.id);
    txList.appendChild(li);
  });
}

searchInput.oninput = renderAll;
filterSelect.onchange = renderAll;

load();
</script>
</body>
</html>
